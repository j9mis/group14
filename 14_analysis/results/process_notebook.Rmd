---
title: "process_notebook"
author: "Group 14"
date: "5/4/2017"
output: html_document
---
```{r setup, warning=FALSE, message=F, echo=FALSE}
library(jsonlite)
library(stringr)
library(tidyverse)
library(readr)

data <- read_csv('14_data_3.csv')
```


# Abstract: 
One paragraph at the very beginning of the document summarizing everything.
```{r}

```


# Overview and Motivation: 
Provide an overview of the project goals and the motivation for it. Consider that this will be read by people who did not see your project proposal.
```{r}

```


# Related Work: 
Anything that inspired you, such as a paper, a web site, or something we discussed in class.
```{r}

```


# Initial Questions: 
What questions are you trying to answer? 
How did these questions evolve over the course of the project? 
What new questions did you consider in the course of your analysis? 


# Data: 
Source, scraping method, cleanup, storage, etc.

### Sources

* **[FiveThirtyEight](https://github.com/fivethirtyeight/data/tree/master/police-killings):**  
We origionally chose our topic after stumbling upon the police killings dataset in FiveThirtyEight's github repository, however, this dataset only contained data for half of 2015. 

* **[BuzzFeed](https://github.com/BuzzFeedNews/2015-12-fatal-police-shootings):**   
We used a dataset from Buzzfeed's github repositrory that they obtained from the Guardian, however, this dataset was missing data after December 6th. 

* **[The Guardian](https://www.theguardian.com/us-news/ng-interactive/2015/jun/01/about-the-counted)**   
We combined The Guardian's post December 7th data with out dataset. These last points were missing latitude and longidude variables, but we added them later.  


### APIs
* **National Broadband Map Census API**   
    + input latitude and longitude to return corresponding census tract  
* **Google Maps API**  
    + input address to return corresponding county  
* **US Census API**   
    + input state and county to return census data 
    
### Cleanup 



```{r}

```


# Exploratory Data Analysis: 
What visualizations did you use to look at your data in different ways? 
What are the different statistical methods you considered? 
Justify the decisions you made, and show any major changes to your ideas. 
How did you reach these conclusions?
```{r}

```


### Time 
The following plot shows the number of people killed by police during each month of 2015.  
There appears to be somewhat of a cycle in which the numer of deaths per month rises to a peak and then begins to decline before rising again. 
This could possibly be due to the nature of media coverage or the time of year. 
```{r, echo = FALSE}
date_count <- data %>% group_by(month_num) %>% count()
ggplot(date_count) + 
    geom_line(aes(x=month_num, y=n), color="#FF9999") +
    geom_point(aes(x=month_num, y=n), stat = "identity") + 
    ggtitle('Police Killed by Police in 2015') +
    labs(x = 'Month', y = '# of people killed by police') + 
    theme(axis.line.x = element_line(color = "black", size=.1),
        axis.line.y = element_line(color="black", size = .1), 
          panel.background = element_blank()) +
    scale_x_discrete(limits=c("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"),
                     labels=c("Jan","Feb","Mar","Apr","May","Jun", "Jul", "Aug", "Sep", "Oct", "Nov","Dec"))  
```

### Age & Gender

The graph below shows the age distribution of the US population. We see that a lot of the popopulation falls pretty evenly between ages 0 to 55. There are clusters from 15 to 30 and from 40 t0 55. The population declines steadily after age 55.  
<img src="http://www.randalolson.com/wp-content/uploads/pop_pyramid_grouped_annotated.png" width="700" height="350" />

Looking at the age distribution of people killed by police, we can see that is does not have the same general shape of the age distribution of the US popultion. The distribution is skewed, indicating that young adults are killed by police more than children, middle-aged people, and the elderly.     
From this graph, we also note how many more men are killed by police than women. 
```{r echo=FALSE, warning=FALSE}
data_age <- na.omit(select(data,age,gender))
ggplot(data_age) + geom_histogram(aes(x=age, fill=gender), binwidth = 4,position="dodge") + scale_fill_manual(values=c("Female"="#CC6699", "Male"="#6699CC", "Non-conforming"="#CC99FF")) +
    ggtitle('Age Distribution of People Killed by Police') + labs(x = 'Age', y = '# of people killed') +
    theme(panel.background = element_blank(), 
          axis.line = element_line(colour = "black", size=.1))+
    scale_x_continuous(breaks=c(0,20, 40, 60, 80),
                       limits=c(0,90),
                       expand=c(0, 1)) +
    scale_y_continuous(breaks=c(0, 50, 100, 150),
                       limits=c(0, 150),
                       expand=c(0,0)) 
```

### Race 
```{r, echo=FALSE, warning=FALSE}
pop_2015 = 321418820

asian_share = 0.056
black_share = 0.133
hispanic_share = 0.176
native_share = 0.012
white_share = 0.616

per_million_counts <- function(race_count){
    race_count$per_million <- NA
    for (i in 1:nrow(race_count)){
        if (race_count$raceethnicity[i] == "Asian/Pacific Islander"){
            race_count$per_million[i] = ((race_count$n[race_count$raceethnicity=="Asian/Pacific Islander"])*1000000)/(pop_2015*asian_share)
        } else if (race_count$raceethnicity[i] == "Black"){
            race_count$per_million[i] =     ((race_count$n[race_count$raceethnicity=="Black"])*1000000)/(pop_2015*black_share)
        } else if (race_count$raceethnicity[i] == "Hispanic/Latino"){ 
            race_count$per_million[i] = ((race_count$n[race_count$raceethnicity=="Hispanic/Latino"])*1000000)/(pop_2015*hispanic_share)
        } else if (race_count$raceethnicity[i] == "Native American"){ 
            race_count$per_million[i] = 
                ((race_count$n[race_count$raceethnicity=="Native American"])*1000000)/(pop_2015*native_share)
        } else if (race_count$raceethnicity[i] == "White"){ 
            race_count$per_million[i] = ((race_count$n[race_count$raceethnicity=="White"])*1000000)/(pop_2015*white_share)
        } else race_count$per_million[i] = NA       
    }
    return(race_count)
}
```

```{r, echo=FALSE, warning=FALSE}
race_count <- data %>% group_by(raceethnicity) %>% count()
race_count <- per_million_counts(race_count)
# Make a histogram
ggplot(na.omit(race_count)) + geom_bar(aes(x=raceethnicity, y=per_million), stat = "identity", fill="#FF9999") + 
    theme(axis.text.x=element_text(angle=45,hjust=1,vjust=1), axis.line = element_line(colour = "black", size=.1),
          panel.background = element_blank()) +
    ggtitle('People Killed by Police by Race/Ethnicity') +
    labs(x = 'Race/Ethnicity', y = '# killed (per million)')
```

```{r, echo=FALSE, warning=FALSE}
race_count_armed <- data %>% filter(is_armed==0) %>% group_by(raceethnicity) %>% count()
race_count_armed <- per_million_counts(race_count_armed)
# Make a histogram
ggplot(na.omit(race_count_armed)) + geom_bar(aes(x=raceethnicity, y=per_million), stat = "identity", fill="#FF9999") + 
    theme(axis.text.x=element_text(angle=45,hjust=1,vjust=1), axis.line = element_line(colour = "black", size=.1),
          panel.background = element_blank()) +
    ggtitle('Unarmed People Killed by Police by Race/Ethnicity') +
    labs(x = 'Race/Ethnicity', y = '# killed (per million)')
```





# Final Analysis: 
What did you learn about the data? 
How did you answer the questions? 
How can you justify your answers?
```{r}

```






